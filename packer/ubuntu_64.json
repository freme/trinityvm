{
    "variables": 
	{
        "ssh_name": "ubuntu",
        "ssh_pass": "ubuntu",
        "hostname": "trinityvm-test"
    },

    "builders": 
	[
		{
	        "type": "virtualbox-iso",
	        "guest_os_type": "Ubuntu_64",

	        "vboxmanage":
			[
	            ["modifyvm", "{{.Name}}", "--vram", "12"],
				["modifyvm", "{{.Name}}", "--memory", "4096"]
	        ],

	        "disk_size" : 10000,
	
	        "iso_url": "http://releases.ubuntu.com/14.04.1/ubuntu-14.04-server-amd64.iso",
	        "iso_checksum": "01545fa976c8367b4f0d59169ac4866c",
	        "iso_checksum_type": "md5",
	
	        "http_directory" : "ubuntu_64",
	        "http_port_min" : 9001,
	        "http_port_max" : 9001,
	
	        "ssh_username": "{{user `ssh_name`}}",
	        "ssh_password": "{{user `ssh_pass`}}",
	        "ssh_wait_timeout": "20m",
	
	        "shutdown_command": "echo {{user `ssh_pass`}} | sudo -S shutdown -P now",
	
	        "boot_command" : 
			[
	            "<esc><esc><enter><wait>",
	            "/install/vmlinuz noapic ",
	            "preseed/url=http://zih-a35.github.io/trinityvm/download/preseed.cfg ",
	            "debian-installer=en_US auto locale=en_US kbd-chooser/method=us ",
	            "hostname={{user `hostname`}} ",
	            "fb=false debconf/frontend=noninteractive ",
	            "keyboard-configuration/modelcode=SKIP keyboard-configuration/layout=USA ",
	            "keyboard-configuration/variant=USA console-setup/ask_detect=false ",
	            "initrd=/install/initrd.gz -- <enter>"
	        ]

	    }
	],
  	"provisioners": 
	[
		{
		    "type": "shell",
    		"execute_command": "echo 'ubuntu' | sudo -S sh '{{ .Path }}'",
 		   "inline": 
			[
				"echo 'ubuntu ALL=NOPASSWD:ALL' > /tmp/ubuntu",
      			"chmod 0440 /tmp/ubuntu",
				"mv /tmp/ubuntu /etc/sudoers.d/",
				"sudo su",
				"apt-get -y install vim",
				"apt-get -y install openssh-server",
				"apt-get -y install unzip",
				"apt-get -y install git",
				"apt-get -y install subversion",
				"echo ' ' >> /etc/network/interfaces",
				"echo 'auto eth1' >> /etc/network/interfaces",
				"echo 'iface eth1 inet dhcp' >> /etc/network/interfaces",
				"ifconfig eth1 up",
				"mkdir .ssh",
				"wget https://raw.githubusercontent.com/zih-a35/trinityvm/master/download/trinityvm.pub",
				"mv trinityvm.pub ./.ssh/authorized_keys",
				"wget https://raw.githubusercontent.com/zih-a35/trinityvm/master/scripts/trinitybuilder",
				"chmod +x trinitybuilder"

		    ]
		}
	]
}
